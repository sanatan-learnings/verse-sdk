# verse-generate

Unified command for generating complete verse content with text, images, and audio.

## Synopsis

```bash
verse-generate --chapter N --verse M [OPTIONS]
```

## Description

The `verse-generate` command is the primary tool for creating complete verse content. It can:
- Fetch Sanskrit text from GPT-4 automatically
- Fetch chapter names from GPT-4 automatically
- Generate verse files with translations and commentary
- Create scene descriptions for images
- Generate images using DALL-E 3
- Generate audio pronunciations using ElevenLabs

All of this from a single command.

## Options

### Required

- `--verse N` - Verse number (required)

### Optional

- `--chapter N` - Chapter number (optional for texts like Hanuman Chalisa)
- `--all` - Generate everything: text, image prompt, image, and audio
- `--text` - Generate only verse text file
- `--prompt` - Generate only scene description (image prompt)
- `--image` - Generate only image
- `--audio` - Generate only audio
- `--theme NAME` - Image theme name (default: modern-minimalist)
- `--sanskrit TEXT` - Provide Sanskrit text (optional, auto-fetched if not provided)
- `--chapter-name-en NAME` - English chapter name (optional, auto-fetched)
- `--chapter-name-hi NAME` - Hindi chapter name (optional, auto-fetched)

## Examples

### Simplest Usage (Recommended)

Generate everything automatically:

```bash
verse-generate --chapter 3 --verse 5 --all
```

This automatically:
- Fetches Sanskrit text from GPT-4
- Fetches chapter names from GPT-4
- Generates complete verse file
- Creates scene description
- Generates image
- Generates audio (full + slow speeds)

### Generate Specific Components

```bash
# Only text content
verse-generate --chapter 3 --verse 5 --text

# Only scene description
verse-generate --chapter 3 --verse 5 --prompt

# Only image
verse-generate --chapter 3 --verse 5 --image

# Only audio
verse-generate --chapter 3 --verse 5 --audio

# Image and audio together
verse-generate --chapter 3 --verse 5 --image --audio
```

### With Custom Sanskrit

If you want to provide your own Sanskrit text:

```bash
verse-generate --chapter 3 --verse 5 --all \
  --sanskrit "न हि कश्चित्क्षणमपि जातु तिष्ठत्यकर्मकृत्।
कार्यते ह्यवशः कर्म सर्वः प्रकृतिजैर्गुणैः।।"
```

### Without Chapters (e.g., Hanuman Chalisa)

```bash
verse-generate --verse 12 --all
```

## Generated Files

When using `--all`, the command creates:

1. **Verse file**: `_verses/chapter_XX_verse_YY.md`
   - Complete YAML frontmatter
   - Sanskrit, transliteration, translations
   - Word meanings, interpretations
   - Story context and practical applications
   - ⚠️ Requires manual review and formatting

2. **Scene description**: `docs/image-prompts.md`
   - Appends scene description for the verse
   - Used by DALL-E 3 for image generation

3. **Image**: `images/THEME_NAME/chapter-XX-verse-YY.png`
   - Generated by DALL-E 3
   - Portrait format (1024x1792)
   - Styled according to theme configuration

4. **Audio files**: `audio/chapter_XX_verse_YY_*.mp3`
   - `chapter_XX_verse_YY_full.mp3` - Full speed
   - `chapter_XX_verse_YY_slow.mp3` - Slow speed (0.75x)

## Workflow

### Complete Automation

```bash
# 1. Generate everything
verse-generate --chapter 2 --verse 47 --all

# 2. Review generated files
cat _verses/chapter_02_verse_47.md
open images/modern-minimalist/chapter-02-verse-47.png

# 3. Edit verse file to match your project's structure
# (See existing verses as examples)

# 4. Test locally
bundle exec jekyll serve  # or your project's preview command

# 5. Commit
git add _verses/ docs/image-prompts.md images/ audio/
git commit -m "Add Chapter 2, Verse 47"
```

### Regenerate Specific Components

```bash
# Regenerate just the image
verse-generate --chapter 2 --verse 47 --image

# Regenerate just the audio
verse-generate --chapter 2 --verse 47 --audio
```

## Requirements

- **For --text / --prompt**: `OPENAI_API_KEY` environment variable
- **For --image**: `OPENAI_API_KEY` + scene description in `docs/image-prompts.md`
- **For --audio**: `ELEVENLABS_API_KEY` + verse file with `devanagari:` field

## Notes

- The `--text` option generates AI content that requires human review for accuracy
- Always verify translations and interpretations against authoritative sources
- Scene descriptions are created automatically but can be edited before image generation
- Audio generation reads from the `devanagari:` field in verse files

## See Also

- [verse-images](verse-images.md) - Image generation details
- [verse-audio](verse-audio.md) - Audio generation details
- [Troubleshooting](../troubleshooting.md) - Common issues
